(this["webpackJsonpreact-flow-test"]=this["webpackJsonpreact-flow-test"]||[]).push([[0],{13:function(t,e,n){},22:function(t,e,n){},29:function(t,e,n){"use strict";n.r(e);var i=n(0),o=n.n(i),r=n(5),c=n.n(r),l=(n(22),function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,35)).then((function(e){var n=e.getCLS,i=e.getFID,o=e.getFCP,r=e.getLCP,c=e.getTTFB;n(t),i(t),o(t),r(t),c(t)}))}),a=n(2),u=n(4),s=n(3),d=Object(i.createContext)();function b(){var t=Object(i.useContext)(d);if(void 0===t)throw new Error("useCount must be used within a CountProvider");return t}var p=n(34),f=n(1);var j=function(t){var e=t.children,n=o.a.useState(null),r=Object(s.a)(n,2),c=r[0],l=r[1],a=o.a.useState(),b=Object(s.a)(a,2),j=b[0],_=b[1],m=Object(i.useRef)(),O=Object(p.a)(m.current,j,{placement:"bottom-start"}),h=O.styles,v=O.attributes,M=Object(i.useMemo)((function(){return{getRect:function(){return null==m.current?{top:0,left:0,right:0,bottom:0,width:0,height:0}:m.current.getBoundingClientRect()},hide:function(){l(null)},show:function(t){l(t)},setRect:function(t){m.current={getBoundingClientRect:function(){return t}}},setPopperElement:_}}),[]);return Object(f.jsxs)(d.Provider,{value:M,children:[e,Object(f.jsx)("div",Object(u.a)(Object(u.a)({ref:function(t){return t&&_(t)},style:h.popper},v.popper),{},{children:c}))]})},_=n(7),m={fontSize:12,height:"100%",resize:"none",width:"100%"},O={display:"flex",position:"absolute",right:"100%",top:-10,transform:"rotate(-90deg)",transformOrigin:"bottom right"};function h(){var t=Object(a.i)((function(t){return t.nodes})),e=Object(a.i)((function(t){return t.edges})),n=Object(i.useState)(!1),o=Object(s.a)(n,2),r=o[0],c=o[1],l=Object(i.useMemo)((function(){return function(t){return{height:"100%",padding:10,position:"absolute",right:0,top:0,transform:t?"translateX(0)":"translateX(100%)",transition:"transform 0.4s ease",width:400}}(r)}),[r]);var d=Object(i.useCallback)((function(t){}));function b(n,i){var o,r,c=[],l=null!==(o=function(t,e){return e.filter((function(e){return e.target===t.id}))}(n,e))&&void 0!==o?o:[],a=1;return l.forEach((function(e){var n,i=(n=e.source,t.find((function(t){return t.id===n}))),o=a+":"+i.data.frescoid+":"+e.sourceHandle;c.push(o),a++})),{id:n.data.frescoid,type:n.type,event:n.data.event,parameters:null!==(r=n.data.parameters)&&void 0!==r?r:[],inputs:c}}var p=Object(i.useCallback)((function(){return c((function(t){return!t}))}),[]);return Object(f.jsxs)("div",{style:l,children:[Object(f.jsx)("textarea",{onChange:d,editable:"false",spellCheck:"false",style:m,value:function(){var e=[];return t.map((function(t,n){return t.data.frescoid=n+1,e.push(b(t)),b(t)})),JSON.stringify({frescoModules:e.map((function(t){return Object(u.a)(Object(u.a)({},t),{},{__rf:void 0})}))},null,2)}()}),Object(f.jsx)("div",{style:O,children:Object(f.jsx)("button",{onClick:p,children:r?"hide":"application"})})]})}n(13);function v(t,e,n,i){return{id:t+"-"+Object(_.v4)(),type:t,position:i,data:Object.assign({},{frescoid:"0",label:e},n)}}function M(t){var e,n=b(),o=Object(i.useMemo)((function(){return{background:"#".concat(t.id.substr(-6))}}),[t.id]),r=Object(a.i)((function(t){return t.nodes}));function c(t){return r.find((function(e){return e.id===t}))}var l=function(t){var e=c(t.source),n=c(t.target);return!(!e.data.outputs||!n.data.inputs)&&e.data.outputs[t.sourceHandle-1]===n.data.inputs[t.targetHandle-1]},u=Object(i.useCallback)((function(){n.hide()}),[n]);return Object(f.jsxs)("div",{className:"customNode",title:t.id,onClick:u,children:[Object(f.jsx)("div",{className:"customNode_header",children:null!==(e=t.title)&&void 0!==e?e:t.type}),Object(f.jsxs)("div",{className:"customNode_body",children:[t.inputs&&Object(f.jsx)("div",{className:"customNode_inputs",children:t.inputs.map((function(t,e){return Object(f.jsxs)("div",{className:"customNode_item",children:[Object(f.jsx)(a.c,{id:(e+1).toString(),position:a.d.Left,style:o,type:"target",isValidConnection:l}),t]},t)}))}),t.outputs&&Object(f.jsx)("div",{className:"customNode_outputs",children:t.outputs.map((function(t,e){return Object(f.jsxs)("div",{className:"customNode_item",children:[Object(f.jsx)(a.c,{id:(e+1).toString(),position:a.d.Right,style:o,type:"source",isValidConnection:l}),t]},t)}))}),t.children]})]})}var F=o.a.memo(M);function x(t){return v("FM_drop_flow","FM_drop_flow",{event:"PUSH",inputs:["bool"]},t.position)}var g=function(t){var e=t.data,n=t.id,i=(t.selected,t.nodeType);return Object(f.jsx)(F,{id:n,title:"FM_drop_flow",type:i,inputs:e.inputs})},w=o.a.memo(g);function y(t){return v("FM_flow_sourceIP","FM_flow_sourceIP",{event:"INCOMMING_FLOW",outputs:["ip_address"]},t.position)}var N=function(t){var e=t.data,n=t.id,i=(t.selected,t.nodeType);return Object(f.jsx)(F,{id:n,title:"FM_flow_sourceIP",type:i,outputs:e.outputs})};function C(t){return v("FM_flow_sourcePort","FM_flow_sourcePort",{event:"INCOMMING_FLOW",outputs:["port"]},t.position)}var P=function(t){var e=t.data,n=t.id,i=(t.selected,t.nodeType);return Object(f.jsx)(F,{id:n,title:"FM_flow_sourcePort",type:i,outputs:e.outputs})},I=o.a.memo(P);function k(t){return v("FM_match_ip","FM_match_ip",{event:"PULL",parameters:["0.0.0.0"],outputs:["bool"],inputs:["ip_address"],setElements:t.setElements},t.position)}var S=function(t){var e=t.data,n=t.id,o=t.selected,r=t.nodeType,c=Object(i.useState)(e.parameters[0]),l=Object(s.a)(c,2),a=l[0],d=l[1],b=Object(i.useState)(e.event),p=Object(s.a)(b,2),j=p[0],_=p[1],m=e.setElements;return Object(i.useEffect)((function(){m((function(t){return t.map((function(t){return t.id===n&&(t.data=Object(u.a)(Object(u.a)({},t.data),{},{parameters:[a],event:j})),t}))}))}),[a,j,n,m]),Object(f.jsx)("div",{children:Object(f.jsx)(F,{id:n,title:"FM_match_ip: ".concat(a),type:r,inputs:e.inputs,outputs:e.outputs,children:o&&Object(f.jsxs)("div",{className:"customNode_editor",children:[Object(f.jsxs)("div",{className:"customNode_item",children:[Object(f.jsx)("span",{children:"IP Address:"}),Object(f.jsx)("input",{onChange:function(t){return d(t.target.value)},value:a})]}),Object(f.jsxs)("div",{className:"customNode_item",children:[Object(f.jsx)("span",{children:"Event:"}),Object(f.jsx)("input",{onChange:function(t){return _(t.target.value)},value:j})]})]})})})},E=o.a.memo(S);function T(t){return v("FM_match_port","FM_match_port",{event:"PULL",parameters:["80"],outputs:["bool"],inputs:["port"],setElements:t.setElements},t.position)}var L=function(t){var e=t.data,n=t.id,o=t.selected,r=t.nodeType,c=Object(i.useState)(e.parameters[0]),l=Object(s.a)(c,2),a=l[0],d=l[1],b=e.setElements;return Object(i.useEffect)((function(){b((function(t){return t.map((function(t){return t.id===n&&(t.data=Object(u.a)(Object(u.a)({},t.data),{},{parameters:[a]})),t}))}))}),[a,n,b]),Object(f.jsx)("div",{children:Object(f.jsx)(F,{id:n,title:"FM_match_port: ".concat(a),type:r,inputs:e.inputs,outputs:e.outputs,children:o&&Object(f.jsx)("div",{className:"customNode_editor",children:Object(f.jsxs)("div",{className:"customNode_item",children:[Object(f.jsx)("span",{children:"Port:"}),Object(f.jsx)("input",{onChange:function(t){return d(t.target.value)},value:a})]})})})})},R=o.a.memo(L);function A(t){return v("FM_flow_destinationIP","FM_flow_destinationIP",{event:"INCOMMING_FLOW",outputs:["integer"]},t.position)}var B=function(t){var e=t.data,n=t.id,i=(t.selected,t.nodeType);return Object(f.jsx)(F,{id:n,title:"FM_flow_destinationIP",type:i,outputs:e.outputs})},G=o.a.memo(B);function H(t){return v("FM_logic_and","FM_logic_and",{event:"PUSH",inputs:["bool","bool"],outputs:["bool"]},t.position)}var U=function(t){var e=t.data,n=t.id,i=(t.selected,t.nodeType);return Object(f.jsx)(F,{id:n,title:"FM_logic_and",type:i,inputs:e.inputs,outputs:e.outputs})},D=o.a.memo(U),q=function(t,e){return console.log()},z=function(t){return console.log("flow loaded:",t)},J=[];function W(t){return 10*Math.floor(t/10)}function X(){var t={FM_drop_flow:w,FM_flow_sourceIP:N,FM_flow_destinationIP:G,FM_flow_sourcePort:I,FM_match_ip:E,FM_match_port:R,FM_logic_and:D},e=b(),n=Object(i.useState)(J),o=Object(s.a)(n,2),r=o[0],c=o[1],l=Object(i.useCallback)((function(t){var n,i={x:W(e.getRect().left),y:W(e.getRect().top)};n=t({setElements:c,position:i}),c((function(t){return t.concat([n])})),e.hide()}),[e,c]),u=Object(i.useCallback)((function(){e.hide()}),[e]),d=Object(i.useCallback)((function(t){t.preventDefault(),e.setRect({width:0,height:0,top:t.clientY,right:0,bottom:0,left:t.clientX}),e.show(Object(f.jsx)(p,{}))}),[e]);function p(){return Object(f.jsx)("ul",{className:"contextMenu",children:j.map((function(t){return Object(f.jsxs)("li",{children:[t.label,Object(f.jsx)("span",{children:"\u276f"}),t.items&&Object(f.jsx)("ul",{className:"contextMenu sub",children:t.items.map((function(t){return Object(f.jsx)("li",{onClick:function(){return l(t.build)},children:t.label},t.label)}))})]},t.label)}))})}var j=[{items:[{label:"FM_flow_sourceIP",build:y},{label:"FM_flow_destinationIP",build:A},{label:"FM_flow_sourcePort",build:C},{label:"FM_flow_destinationPort",build:y},{label:"FM_flow_sourceMAC",build:y},{label:"FM_flow_destinationMAC",build:y},{label:"FM_flow_arpSender",build:y},{label:"FM_flow_arpTarget",build:y},{label:"FM_flow_tcpip",build:y},{label:"FM_drop_flow",build:x},{label:"FM_match_ip",build:k}],label:"Flow Utilities"},{items:[{label:"FM_match_ip",build:k},{label:"FM_match_port",build:T},{label:"FM_match_mac",build:k},{label:"FM_arith_equal",build:k},{label:"FM_arith_larger",build:k},{label:"FM_arith_smaller",build:k},{label:"FM_logic_and",build:H},{label:"FM_logic_or",build:k},{label:"FM_count_ip",build:k},{label:"FM_output_bool",build:k},{label:"FM_output_int",build:k},{label:"FM_output_ip",build:k},{label:"FM_output_mac",build:k}],label:"Basic Operations"},{items:[{label:"FM_drop_flow",build:x},{label:"FM_forward_flow",build:k},{label:"FM_mirror_flow",build:k},{label:"FM_redirect_ip",build:k},{label:"FM_block_ip",build:k},{label:"FM_quarantine_ip",build:k}],label:"Security Actions"},{items:[{label:"FM_find_scan",build:k},{label:"FM_find_arpSpoofing",build:k}],label:"Network Attack Detection"},{items:[{label:"FM_load_balance",build:k}],label:"Network Service"},{items:[{label:"FM_find_bufferoverflow",build:k},{label:"FM_http_extGuard",build:k},{label:"FM_calc_interval_freq",build:k}],label:"Third Party"}];return Object(f.jsx)("div",{className:"reactflow-wrapper",children:Object(f.jsxs)(a.g,{elements:r,onElementClick:q,onConnect:function(t){return c((function(e){return Object(a.f)(t,e)}))},onElementsRemove:function(t){return c((function(e){return Object(a.h)(t,e)}))},onLoad:z,nodeTypes:t,onPaneClick:u,onPaneContextMenu:d,selectNodesOnDrag:!1,snapGrid:[10,10],style:{zIndex:0},children:[Object(f.jsx)(a.a,{gap:10}),Object(f.jsx)(a.b,{})]})})}var V=function(){return Object(f.jsx)("div",{className:"providerflow",children:Object(f.jsx)(a.e,{children:Object(f.jsx)(j,{children:Object(f.jsxs)("div",{style:{alignItems:"stretch",display:"flex",height:"100vh"},children:[Object(f.jsx)(X,{}),Object(f.jsx)(h,{})]})})})})};c.a.render(Object(f.jsx)(o.a.StrictMode,{children:Object(f.jsx)(V,{})}),document.getElementById("root")),l()}},[[29,1,2]]]);
//# sourceMappingURL=main.4560a6bc.chunk.js.map