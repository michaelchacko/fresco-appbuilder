(this["webpackJsonpreact-flow-test"]=this["webpackJsonpreact-flow-test"]||[]).push([[0],{14:function(t,e,n){},24:function(t,e,n){},31:function(t,e,n){"use strict";n.r(e);var o=n(0),i=n.n(o),r=n(6),c=n.n(r),a=(n(24),function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(e){var n=e.getCLS,o=e.getFID,i=e.getFCP,r=e.getLCP,c=e.getTTFB;n(t),o(t),i(t),r(t),c(t)}))}),u=n(4),s=n(3),l=n(2),d=Object(o.createContext)();function b(){var t=Object(o.useContext)(d);if(void 0===t)throw new Error("useCount must be used within a CountProvider");return t}var p=n(36),f=n(1);var j=function(t){var e=t.children,n=i.a.useState(null),r=Object(u.a)(n,2),c=r[0],a=r[1],s=i.a.useState(),b=Object(u.a)(s,2),j=b[0],m=b[1],_=Object(o.useRef)(),O=Object(p.a)(_.current,j,{placement:"bottom-start"}),h=O.styles,v=O.attributes,M=Object(o.useMemo)((function(){return{getRect:function(){return null==_.current?{top:0,left:0,right:0,bottom:0,width:0,height:0}:_.current.getBoundingClientRect()},hide:function(){a(null)},show:function(t){a(t)},setRect:function(t){_.current={getBoundingClientRect:function(){return t}}},setPopperElement:m}}),[]);return Object(f.jsxs)(d.Provider,{value:M,children:[e,Object(f.jsx)("div",Object(l.a)(Object(l.a)({ref:function(t){return t&&m(t)},style:h.popper},v.popper),{},{children:c}))]})},m=n(7),_=Object(o.createContext)();function O(){var t=Object(o.useContext)(_);if(void 0===t)throw new Error("useCount must be used within a CountProvider");return t}var h={fontSize:12,height:"100%",resize:"none",width:"100%"},v={display:"flex",position:"absolute",right:"100%",top:-10,transform:"rotate(-90deg)",transformOrigin:"bottom right"},M=function(){return{id:Object(m.v4)(),elements:[],transform:{x:0,y:0,zoom:1}}};function x(){var t=Object(s.i)((function(t){return t.nodes})),e=Object(s.i)((function(t){return t.edges})),n=Object(o.useState)(!1),i=Object(u.a)(n,2),r=i[0],c=i[1],a=Object(o.useMemo)((function(){return function(t){return{height:"100%",padding:10,position:"absolute",right:0,top:0,transform:t?"translateX(0)":"translateX(100%)",transition:"transform 0.4s ease",width:400}}(r)}),[r]),d=O(),b=d.elements,p=d.id,j=d.setElements,_=d.setId,x=d.setTransform,F=d.transform;function g(n,o){var i,r,c=[],a=null!==(i=function(t,e){return e.filter((function(e){return e.target===t.id}))}(n,e))&&void 0!==i?i:[],u=1;return a.forEach((function(e){var n=function(e){return t.find((function(t){return t.id===e}))}(e.source),o=u+":"+n.data.frescoid+":"+e.sourceHandle;c.push(o),u++})),{id:n.data.frescoid,type:n.type,event:n.data.event,parameters:null!==(r=n.data.parameters)&&void 0!==r?r:[],inputs:c}}Object(o.useEffect)((function(){var t=atob(window.location.hash.substr(1));try{var e=JSON.parse(t),n=e.elements,o=e.id,i=e.transform;j(n),_(null!==o&&void 0!==o?o:Object(m.v4)()),x(i)}catch(r){console.error(r)}}),[j,_,x]),Object(o.useEffect)((function(){window.location.hash=btoa(JSON.stringify({elements:b.map((function(t){return Object(l.a)(Object(l.a)({},t),{},{__rf:void 0})})),id:p,transform:F}))}),[b,p,F]);var w=Object(o.useCallback)((function(t){try{var e=JSON.parse(t.target.value),n=e.elements,o=e.id,i=e.transform;j(n),_(null!==o&&void 0!==o?o:Object(m.v4)()),x(i)}catch(t){console.error(t)}}),[j,_,x]),y=Object(o.useCallback)((function(){var t=M();j(t.elements),_(t.id),x(t.transform)}),[j,_,x]),N=Object(o.useCallback)((function(){return c((function(t){return!t}))}),[]),C=Object(o.useCallback)((function(){var t=document.createElement("a"),e=new Blob([document.getElementById("frescoOutput").value],{type:"text/plain"});t.href=URL.createObjectURL(e),t.download="new_fresco_application.fre",document.body.appendChild(t),t.click()}),[]);return Object(f.jsxs)("div",{style:a,children:[Object(f.jsx)("textarea",{onChange:w,editable:"false",spellCheck:"false",id:"frescoOutput",style:h,value:function(){var e=[];return t.map((function(t,n){return t.data.frescoid=n+1,e.push(g(t)),g(t)})),JSON.stringify({frescoModules:e.map((function(t){return Object(l.a)(Object(l.a)({},t),{},{__rf:void 0})}))},null,2)}()}),Object(f.jsxs)("div",{style:v,children:[Object(f.jsx)("button",{onClick:y,style:{marginRight:20},children:"clear"}),Object(f.jsx)("button",{onClick:C,style:{marginRight:10},children:"download"}),Object(f.jsx)("button",{onClick:N,children:r?"hide":"application"})]})]})}var F=n(17);n(14);function g(t,e,n,o){return{id:t+"-"+Object(m.v4)(),type:t,position:o,data:Object.assign({},{frescoid:"0",label:e},n)}}function w(t){var e,n=b(),i=Object(o.useMemo)((function(){return{background:"#".concat(t.id.substr(-6))}}),[t.id]),r=Object(s.i)((function(t){return t.nodes}));function c(t){return r.find((function(e){return e.id===t}))}var a=function(t){var e=c(t.source),n=c(t.target);return!(!e.data.outputs||!n.data.inputs)&&e.data.outputs[t.sourceHandle-1]===n.data.inputs[t.targetHandle-1]},u=Object(o.useCallback)((function(){n.hide()}),[n]);return Object(f.jsxs)("div",{className:"customNode",title:t.id,onClick:u,children:[Object(f.jsx)("div",{className:"customNode_header",children:null!==(e=t.title)&&void 0!==e?e:t.type}),Object(f.jsxs)("div",{className:"customNode_body",children:[t.inputs&&Object(f.jsx)("div",{className:"customNode_inputs",children:t.inputs.map((function(t,e){return Object(f.jsxs)("div",{className:"customNode_item",children:[Object(f.jsx)(s.c,{id:(e+1).toString(),position:s.d.Left,style:i,type:"target",isValidConnection:a}),t]},t)}))}),t.outputs&&Object(f.jsx)("div",{className:"customNode_outputs",children:t.outputs.map((function(t,e){return Object(f.jsxs)("div",{className:"customNode_item",children:[Object(f.jsx)(s.c,{id:(e+1).toString(),position:s.d.Right,style:i,type:"source",isValidConnection:a}),t]},t)}))}),t.children]})]})}var y=i.a.memo(w);function N(t){return g("FM_drop_flow","FM_drop_flow",{event:"PUSH",inputs:["bool"]},t.position)}var C=function(t){var e=t.data,n=t.id,o=(t.selected,t.nodeType);return Object(f.jsx)(y,{id:n,title:"FM_drop_flow",type:o,inputs:e.inputs})},P=i.a.memo(C);function S(t){return g("FM_flow_sourceIP","FM_flow_sourceIP",{event:"INCOMMING_FLOW",outputs:["ip_address"]},t.position)}var k=function(t){var e=t.data,n=t.id,o=(t.selected,t.nodeType);return Object(f.jsx)(y,{id:n,title:"FM_flow_sourceIP",type:o,outputs:e.outputs})};function I(t){return g("FM_flow_sourcePort","FM_flow_sourcePort",{event:"INCOMMING_FLOW",outputs:["port"]},t.position)}var E=function(t){var e=t.data,n=t.id,o=(t.selected,t.nodeType);return Object(f.jsx)(y,{id:n,title:"FM_flow_sourcePort",type:o,outputs:e.outputs})},L=i.a.memo(E);function T(t){return g("FM_match_ip","FM_match_ip",{event:"PULL",parameters:["0.0.0.0"],outputs:["bool"],inputs:["ip_address"]},t.position)}var R=function(t){var e=t.data,n=t.id,i=t.selected,r=t.nodeType,c=Object(o.useState)(e.parameters[0]),a=Object(u.a)(c,2),s=a[0],d=a[1],b=Object(o.useState)(e.event),p=Object(u.a)(b,2),j=p[0],m=p[1],_=O().setElements;return Object(o.useEffect)((function(){_((function(t){return t.map((function(t){return t.id===n&&(t.data=Object(l.a)(Object(l.a)({},t.data),{},{parameters:[s],event:j})),t}))}))}),[s,j,n,_]),Object(f.jsx)("div",{children:Object(f.jsx)(y,{id:n,title:"FM_match_ip: ".concat(s),type:r,inputs:e.inputs,outputs:e.outputs,children:i&&Object(f.jsxs)("div",{className:"customNode_editor",children:[Object(f.jsxs)("div",{className:"customNode_item",children:[Object(f.jsx)("span",{children:"IP Address:"}),Object(f.jsx)("input",{onChange:function(t){return d(t.target.value)},value:s})]}),Object(f.jsxs)("div",{className:"customNode_item",children:[Object(f.jsx)("span",{children:"Event:"}),Object(f.jsx)("input",{onChange:function(t){return m(t.target.value)},value:j})]})]})})})},U=i.a.memo(R);function B(t){return g("FM_match_port","FM_match_port",{event:"PULL",parameters:["80"],outputs:["bool"],inputs:["port"]},t.position)}var z=function(t){var e=t.data,n=t.id,i=t.selected,r=t.nodeType,c=Object(o.useState)(e.parameters[0]),a=Object(u.a)(c,2),s=a[0],d=a[1],b=O().setElements;return Object(o.useEffect)((function(){b((function(t){return t.map((function(t){return t.id===n&&(t.data=Object(l.a)(Object(l.a)({},t.data),{},{parameters:[s]})),t}))}))}),[s,n,b]),Object(f.jsx)("div",{children:Object(f.jsx)(y,{id:n,title:"FM_match_port: ".concat(s),type:r,inputs:e.inputs,outputs:e.outputs,children:i&&Object(f.jsx)("div",{className:"customNode_editor",children:Object(f.jsxs)("div",{className:"customNode_item",children:[Object(f.jsx)("span",{children:"Port:"}),Object(f.jsx)("input",{onChange:function(t){return d(t.target.value)},value:s})]})})})})},J=i.a.memo(z);function A(t){return g("FM_flow_destinationIP","FM_flow_destinationIP",{event:"INCOMMING_FLOW",outputs:["integer"]},t.position)}var D=function(t){var e=t.data,n=t.id,o=(t.selected,t.nodeType);return Object(f.jsx)(y,{id:n,title:"FM_flow_destinationIP",type:o,outputs:e.outputs})},G=i.a.memo(D);function H(t){return g("FM_logic_and","FM_logic_and",{event:"PUSH",inputs:["bool","bool"],outputs:["bool"]},t.position)}var q=function(t){var e=t.data,n=t.id,o=(t.selected,t.nodeType);return Object(f.jsx)(y,{id:n,title:"FM_logic_and",type:o,inputs:e.inputs,outputs:e.outputs})},W=i.a.memo(q);function X(t){return g("FM_custom","FM_custom",{event:"PULL",parameters:[],outputs:["output1"],inputs:["input1"]},t.position)}var V=function(t){var e=t.data,n=t.id,i=t.selected,r=t.nodeType,c=Object(o.useState)(e.parameters[0]),a=Object(u.a)(c,2),s=a[0],d=a[1],b=O().setElements;return Object(o.useEffect)((function(){b((function(t){return t.map((function(t){return t.id===n&&(t.data=Object(l.a)(Object(l.a)({},t.data),{},{parameters:[s]})),t}))}))}),[s,n,b]),Object(f.jsx)("div",{children:Object(f.jsx)(y,{id:n,title:"FM_custom: ".concat(s),type:r,inputs:e.inputs,outputs:e.outputs,children:i&&Object(f.jsx)("div",{className:"customNode_editor",children:Object(f.jsxs)("div",{className:"customNode_item",children:[Object(f.jsx)("span",{children:"Custom Parameters:"}),Object(f.jsx)("input",{onChange:function(t){return d(t.target.value)},value:s})]})})})})},Y=i.a.memo(V),K=function(t,e){return console.log()},Q=function(t){return console.log("flow loaded:",t)};function Z(t){return 10*Math.floor(t/10)}function $(){var t={FM_drop_flow:P,FM_flow_sourceIP:k,FM_flow_destinationIP:G,FM_flow_sourcePort:L,FM_match_ip:U,FM_match_port:J,FM_logic_and:W,FM_custom:Y},e=b(),n=O(),i=n.elements,r=n.setElements,c=n.transform,a=Object(o.useCallback)((function(t,n){console.log(t);var o=n({position:{x:Z((e.getRect().left-c.x)/c.zoom),y:Z((e.getRect().top-c.y)/c.zoom)}});console.log("Node added"),r((function(t){return[].concat(Object(F.a)(t),[o])})),e.hide()}),[e,r,c]),u=Object(o.useCallback)((function(t,e){var n={x:Z(e.position.x),y:Z(e.position.y)};r((function(t){return t.map((function(t){return t.id===e.id&&(t.position=n),t}))}))}),[r]),l=Object(o.useCallback)((function(){e.hide()}),[e]),d=Object(o.useCallback)((function(t){t.preventDefault(),e.setRect({width:0,height:0,top:t.clientY,right:0,bottom:0,left:t.clientX}),e.show(Object(f.jsx)(p,{}))}),[e]);function p(){return Object(f.jsx)("ul",{className:"contextMenu",children:j.map((function(t){return Object(f.jsxs)("li",{children:[t.label,Object(f.jsx)("span",{children:"\u276f"}),t.items&&Object(f.jsx)("ul",{className:"contextMenu sub",children:t.items.map((function(t){return Object(f.jsx)("li",{onClick:function(){return a(t.label,t.build)},children:t.label},t.label)}))})]},t.label)}))})}var j=[{items:[{label:"FM_flow_sourceIP",build:S},{label:"FM_flow_destinationIP",build:A},{label:"FM_flow_sourcePort",build:I},{label:"FM_flow_destinationPort",build:S},{label:"FM_flow_sourceMAC",build:S},{label:"FM_flow_destinationMAC",build:S},{label:"FM_flow_arpSender",build:S},{label:"FM_flow_arpTarget",build:S},{label:"FM_flow_tcpip",build:S},{label:"FM_drop_flow",build:N},{label:"FM_match_ip",build:T}],label:"Flow Utilities"},{items:[{label:"FM_match_ip",build:T},{label:"FM_match_port",build:B},{label:"FM_match_mac",build:T},{label:"FM_arith_equal",build:T},{label:"FM_arith_larger",build:T},{label:"FM_arith_smaller",build:T},{label:"FM_logic_and",build:H},{label:"FM_logic_or",build:T},{label:"FM_count_ip",build:T},{label:"FM_output_bool",build:T},{label:"FM_output_int",build:T},{label:"FM_output_ip",build:T},{label:"FM_output_mac",build:T}],label:"Basic Operations"},{items:[{label:"FM_drop_flow",build:N},{label:"FM_forward_flow",build:T},{label:"FM_mirror_flow",build:T},{label:"FM_redirect_ip",build:T},{label:"FM_block_ip",build:T},{label:"FM_quarantine_ip",build:T}],label:"Security Actions"},{items:[{label:"FM_find_scan",build:T},{label:"FM_find_arpSpoofing",build:T}],label:"Network Attack Detection"},{items:[{label:"FM_load_balance",build:T}],label:"Network Service"},{items:[{label:"FM_find_bufferoverflow",build:T},{label:"FM_http_extGuard",build:T},{label:"FM_calc_interval_freq",build:T},{label:"FM_custom",build:X}],label:"Third Party"}];return Object(f.jsx)("div",{className:"reactflow-wrapper",children:Object(f.jsxs)(s.g,{elements:i,onElementClick:K,onConnect:function(t){return r((function(e){return Object(s.f)(t,e)}))},onElementsRemove:function(t){return r((function(e){return Object(s.h)(t,e)}))},onLoad:Q,onNodeDragStop:u,nodeTypes:t,onPaneClick:l,onPaneContextMenu:d,selectNodesOnDrag:!1,snapGrid:[10,10],style:{zIndex:0},children:[Object(f.jsx)(s.a,{gap:10}),Object(f.jsx)(s.b,{})]})})}var tt=function(){var t=Object(o.useMemo)(M,[]),e=Object(o.useState)(t.id),n=Object(u.a)(e,2),i=n[0],r=n[1],c=Object(o.useState)(t.elements),a=Object(u.a)(c,2),l=a[0],d=a[1],b=Object(o.useState)(t.transform),p=Object(u.a)(b,2),m=p[0],O={elements:l,id:i,setElements:d,setId:r,setTransform:p[1],transform:m};return Object(f.jsx)(_.Provider,{value:O,children:Object(f.jsx)("div",{className:"providerflow",children:Object(f.jsx)(s.e,{children:Object(f.jsx)(j,{children:Object(f.jsxs)("div",{style:{alignItems:"stretch",display:"flex",height:"100vh"},children:[Object(f.jsx)($,{},O.id),Object(f.jsx)(x,{})]})})})})})};c.a.render(Object(f.jsx)(i.a.StrictMode,{children:Object(f.jsx)(tt,{})}),document.getElementById("root")),a()}},[[31,1,2]]]);
//# sourceMappingURL=main.657a58a5.chunk.js.map